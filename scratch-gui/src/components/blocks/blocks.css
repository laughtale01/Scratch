@import "../../css/units.css";
@import "../../css/colors.css";
@import "../../css/z-index.css";
@import "./flyout-resizer.css";

.blocks {
    height: 100%;
}

.drag-over:after {
    content: '';
    position: absolute;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    opacity: 0.75;
    background-color: $drop-highlight;
    transition: all 0.25s ease;
}

.blocks :global(.injectionDiv){
    position: absolute;
    top: 0;
    right: 0;
    bottom: 0;
    left: 0;
    /* border: 1px solid $ui-black-transparent; */ /* 重複境界線を削除 */
    border-top-right-radius: $space;
    border-bottom-right-radius: $space;
}

[dir="rtl"] .blocks :global(.injectionDiv) {
    border-top-right-radius: 0;
    border-bottom-right-radius: 0;
    border-top-left-radius: $space;
    border-bottom-left-radius: $space;
}

.blocks :global(.blocklyMainBackground) {
    stroke: none;
}

.blocks :global(.blocklyToolboxDiv) {
    border-right: 1px solid $ui-black-transparent;
    border-bottom: 1px solid $ui-black-transparent;
    box-sizing: content-box;
    height: calc(100% - 3.25rem) !important;

    /*
        For now, the layout cannot support scrollbars in the category menu.
        The line below works for Edge, the `::-webkit-scrollbar` line
        below that is for webkit browsers. It isn't possible to do the
        same for Firefox, so a different solution may be needed for them.
    */
    -ms-overflow-style: none;
}

[dir="rtl"] .blocks :global(.blocklyToolboxDiv) {
    border-right: none;
    border-left: 1px solid $ui-black-transparent;
}

.blocks :global(.blocklyToolboxDiv::-webkit-scrollbar) {
    display: none;
}

.blocks :global(.blocklyFlyout) {
    border-right: 1px solid $ui-black-transparent;
    box-sizing: content-box;
    position: relative;
}

[dir="rtl"] .blocks :global(.blocklyFlyout) {
    border-right: none;
    border-left: 1px solid $ui-black-transparent;
}


.blocks :global(.blocklyBlockDragSurface) {
    /*
        Fix an issue where the drag surface was preventing hover events for sharing blocks.
        This does not prevent user interaction on the blocks themselves.
    */
    pointer-events: none;
    z-index: $z-index-drag-layer; /* make blocks match gui drag layer */
}

/*
    Shrink category font to fit "My Blocks" for now.
    Probably will need different solutions for language support later, so
    make the change here instead of in scratch-blocks.
*/
.blocks :global(.scratchCategoryMenuItemLabel) {
    font-size: 0.65rem;
}

.blocks :global(.blocklyMinimalBody) {
    min-width: auto;
    min-height: auto;
}

/* Match Blockly's native zoom control styling */
.blocks :global(.blocklyZoom > image) {
    opacity: 1 !important;
    cursor: pointer;
}

/* Override any opacity settings from the SVG files */
.blocks :global(.blocklyZoom) {
    opacity: 1 !important;
}

/* Ensure zoom controls are on top of other elements */
.blocks :global(.blocklyZoom) {
    z-index: 20;
}

/* Override internal SVG opacity for zoom control icons */
.blocks :global(.blocklyZoom image .cls-1) {
    opacity: 0.15 !important;
}

.blocks :global(.blocklyZoom image .cls-3) {
    opacity: 1 !important; /* Make the icon fully visible */
}

/* Alternative approach - target all SVG elements inside zoom controls */
.blocks :global(.blocklyZoom svg *) {
    opacity: 1 !important;
}

.blocks :global(.blocklyZoom svg .cls-1) {
    opacity: 0.15 !important; /* Keep background semi-transparent */
}

.blocks :global(.blocklyZoom svg .cls-3) {
    opacity: 1 !important; /* Make icon group fully visible */
}

/* Ensure zoom controls in flyout are visible and clickable */
.blocks :global(.blocklyFlyout .blocklyZoom) {
    opacity: 1 !important;
    pointer-events: all !important;
}

.blocks :global(.blocklyFlyout .blocklyZoom > image) {
    opacity: 1 !important;
    cursor: pointer !important;
}

/* Fix for flyout SVG group zoom controls */
.blocks :global(.blocklyFlyoutBackground ~ .blocklyZoom) {
    opacity: 1 !important;
    pointer-events: all !important;
}

/* Flyout-specific zoom controls */
.blocks :global(.flyout-zoom-controls) {
    opacity: 1 !important;
    pointer-events: all !important;
    z-index: 30 !important; /* Above flyout scrollbar */
}

.blocks :global(.flyout-zoom-controls image) {
    opacity: 1 !important;
    cursor: pointer !important;
}

/* Simple SVG zoom controls */
.blocks :global(.flyout-zoom-simple) {
    opacity: 1 !important;
    pointer-events: all !important;
}

.blocks :global(.flyout-zoom-simple image) {
    opacity: 1 !important;
    cursor: pointer !important;
    pointer-events: all !important;
}

/* Ensure images are interactive */
.blocks :global(.flyout-zoom-simple image:hover) {
    opacity: 0.8 !important;
}

/* Correct flyout zoom controls */
.blocks :global(.flyout-zoom-controls-correct) {
    opacity: 1 !important;
    pointer-events: all !important;
    z-index: 1000 !important;
}

.blocks :global(.flyout-zoom-controls-correct g) {
    opacity: 1 !important;
    cursor: pointer !important;
}

.blocks :global(.flyout-zoom-controls-correct circle) {
    opacity: inherit !important;
}

.blocks :global(.flyout-zoom-controls-correct g[stroke]) {
    opacity: 1 !important;
}

/* Hover effect for buttons */
.blocks :global(.flyout-zoom-controls-correct > g:hover) {
    filter: brightness(0.9);
}

/* Functional flyout zoom controls */
.blocks :global(.flyout-zoom-functional) {
    opacity: 1 !important;
    pointer-events: all !important;
}

.blocks :global(.flyout-zoom-functional g) {
    opacity: 1 !important;
    cursor: pointer !important;
    pointer-events: all !important;
}

.blocks :global(.flyout-zoom-functional circle) {
    opacity: inherit !important;
}

.blocks :global(.flyout-zoom-functional line) {
    opacity: 1 !important;
}

/* Hover effect */
.blocks :global(.flyout-zoom-functional > g:hover circle:first-child) {
    opacity: 0.25 !important;
}

/* Active effect */
.blocks :global(.flyout-zoom-functional > g:active) {
    transform: scale(0.95);
}

/* Flyout resizer styles */
.blocks :global(.flyout-resizer) {
    opacity: 1 !important;
}

.blocks :global(.flyout-resizer:hover) {
    background-color: rgba(76, 151, 255, 0.1) !important;
}

.blocks :global(.flyout-resizer > div) {
    opacity: 1 !important;
}

/* Ensure workspace is properly contained */
.blocks :global(.injectionDiv) {
    overflow: hidden !important;
}

